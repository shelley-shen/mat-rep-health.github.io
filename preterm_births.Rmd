---
title: "Exploratory Analysis of Preterm Births Outcome"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(dplyr)
library(readxl)
library(readr)
library(plotly)

knitr::opts_chunk$set(
	fig.width = 9, 
  fig.asp = .6,
  out.width = "90%"
)
theme_set(theme_minimal() + theme(legend.position = "bottom"))
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

  
```{r, include = FALSE}
plots_df = read_csv("./data/final_regression_variables_clean.csv") %>%
    mutate(poverty_level = cut(poverty, breaks = c(-Inf, 10, 20, 30, 40, Inf), labels = c("poverty_10","poverty_20", "poverty_30", "poverty_40", "poverty_40+"))) %>% 
  pivot_longer(
   cols = hispanic:other_race,
   names_to = "race",
   values_to = "percent_pop",
   values_drop_na = TRUE
 ) 
```

The following plots are an exploration of the relationship between various predictors and the outcome of preterm births.

#### Plot 1: Health Insurance and Preterm Births

```{r}
preterm_ggplot = 
  plots_df %>% 
  ggplot(aes(x = health_ins, y = preterm_births, group = nta_name)) +
  geom_point(color = "blue") + 
  labs(
    title = "Exploration of Health Insurance and  Preterm Births in NYC Neighborhoods",
    x = "Percent Population with Health Insurance",
    y = "Percent Preterm Births Among All Live Births")

ggplotly(preterm_ggplot)
```

Generally in NYC neighborhoods, the overall percentage of people with health insurance is fairly high, with the exception of North Corona where only 58.5% of the population has health insurance. Despite this, it appears that those neighborhoods with less percentage of the population enrolled in health insurance have more percentages of preterm births in the population. There does not seem to be a strong relationship, however, it might be worth exploring this asscoiation through statistical methods and looking at whether health insurance also modifies the association between prenatal care and preterm births.  


#### Plot 2: Prenatal Care and Preterm Births 

```{r}
prenatal_care_ggplot = 
  plots_df %>% 
  ggplot(aes(x = late_no_prenatal_care, y = preterm_births, group = nta_name)) + 
  geom_point(color = "blue") + 
  labs(
    title = "Exploration of Access to Prenatal Care and  Preterm Births in NYC Neighborhoods",
    x = "Percent Live Births Recieving Late or No Prenatal Care",
    y = "Percent Preterm Births Among All Live Births")

ggplotly(prenatal_care_ggplot)
```

There appears to be a clear direct relationship between the percentage of live births that receive late or no prenatal care and percentage of preterm births among all live births in the population. Neighborhoods with higher percentages of late or no prenatal care are more likely to have higher percentages of preterm births. 
