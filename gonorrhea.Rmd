---
title: "Exploratory Analysis of Gonorrhea Outcome"
output: html_document
---


```{r setup, include=FALSE}
library(tidyverse)
library(dplyr)
library(readxl)
library(readr)
library(plotly)

knitr::opts_chunk$set(
	fig.width = 9, 
  fig.asp = .6,
  out.width = "90%"
)
theme_set(theme_minimal() + theme(legend.position = "bottom"))
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```
  
```{r,  include = FALSE}
plots_df = read_csv("./data/final_regression_variables_clean.csv") %>%
    mutate(poverty_level = cut(poverty, breaks = c(-Inf, 10, 20, 30, 40, Inf), labels = c("poverty_10","poverty_20", "poverty_30", "poverty_40", "poverty_40+"))) %>% 
  pivot_longer(
   cols = hispanic:other_race,
   names_to = "race",
   values_to = "percent_pop",
   values_drop_na = TRUE
 ) 
```

The following plots are an exploration of the relationship between various predictors and the outcome of Gonorrhea.

#### Plot 1: Health Insurance and Gonorrhea 

```{r}
gonorrhea1_ggplot = 
  plots_df %>% 
  ggplot(aes(x = health_ins, y = gonorrhea, group = nta_name)) + 
  geom_point(color = "green") + 
  labs(
    title = "Exploration of Health Insurance and  Gonorrhea in NYC Neighborhoods",
    x = "Percent Population with Health Insurance",
    y = "Rate of gonorrhea cases per 100,000 (2014-2015)")

ggplotly(gonorrhea1_ggplot)

```

With the exception of a few outliers, the trend seems to be that neighborhoods with a lower percentage of population enrolled in health insurance have higher rates of gonorrhea cases. The association is not super strong but it is worth exploring further. 


#### Plot 2: Medicaid and Gonorrhea 

```{r}
gonorrhea2_ggplot = 
  plots_df %>% 
  ggplot(aes(x = medicaid_enroll, y = gonorrhea, group = nta_name)) +
  geom_point(color = "green") + 
  labs(
    title = "Exploration of Medicaid Enrollment and Gonorrhea in NYC Neighborhoods (2014-2015)",
    x = "Percent Population Enrolled in Medicaid",
    y = "Rate of gonorrhea cases per 100,000 People")

ggplotly(gonorrhea2_ggplot)

```

There is no strong relationship between percentage of population enrolled in Medicaid and rates of gonorrhea in the neighborhood population. However, there is a slight positive trend where neighborhoods with a higher Medicaid enrollment have higher rates of gonorrhea cases. There are a few outliers that do not follow this trend and indicate really high rates of gonorrhea despite having low medicaid enrollment. 


#### Plot 3: Education and Gonorrhea

```{r}
gonorrhea3_ggplot = 
  plots_df %>% 
  ggplot(aes(x = edu_less_than_hs, y = gonorrhea, group = nta_name)) +
  geom_point(color = "green") + 
  labs(
    title = "Exploration of Education Level and Gonorrhea in NYC Neighborhoods (2014-2015)",
    x = "Percent Population with Less than High School Education",
    y = "Rate of gonorrhea cases per 100,000 people")


ggplotly(gonorrhea3_ggplot)

```

Similar to the association with Medicaid, the association between education level and rates of gonorrhea is not very strong, although, there is a slight positive trend where neighborhoods with higher percentages of the population that have less education also experience higher rates of gonorrhea.    